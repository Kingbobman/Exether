namespace = blood_tribunal

blood_tribunal.1 = {
	type = country_event
	placement = root
	title = blood_tribunal.1.t
	desc = blood_tribunal.1.d
	flavor = blood_tribunal.1.f

	duration = 3

	event_image = {
		video = "unspecific_factory_closed"
	}

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"

	icon = "gfx/interface/icons/event_icons/event_skull.dds"

	trigger = {
	}

	immediate = {
		add_journal_entry = {
			type = je_blood_tribunal
		}
	}

	option = {
		name = blood_tribunal.1.a #the weak will tithe
	}
}

blood_tribunal.2 = {
	type = country_event
	placement = root
	title = blood_tribunal.2.t
	desc = blood_tribunal.2.d
	flavor = blood_tribunal.2.f

	duration = 3

	event_image = {
		video = "unspecific_factory_closed"
	}

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"

	icon = "gfx/interface/icons/event_icons/event_skull.dds"

	trigger = { #triggered by JE success
	}

	immediate = {

	}

	option = {
		name = blood_tribunal.2.a #we have taken our rightful place
	}
}

blood_tribunal.3 = { #event on first tithe
	type = country_event
	placement = root
	title = blood_tribunal.3.t
	desc = blood_tribunal.3.d
	flavor = blood_tribunal.3.f

	duration = 3

	event_image = {
		video = "unspecific_factory_closed"
	}

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"

	icon = "gfx/interface/icons/event_icons/event_skull.dds"

	trigger = { #triggered by JE success
	}

	immediate = {

	}

	option = {
		name = blood_tribunal.3.a #we have taken our rightful place
		set_variable = familiars_handling_tithes
	}
}

blood_tribunal.4 = {
    type = country_event
    placement = root

    title = blood_tribunal.4.t
    desc = blood_tribunal.4.d
    flavor = blood_tribunal.4.f

    duration = 3

    trigger = {
        this = c:RVC
        any_subject_or_below = {
            exists = this
        }
    }

    immediate = {
        every_subject_or_below = {
            ordered_scope_state = {
                order_by = state_population
                reverse = yes
                save_scope_as = most_populated_state
            }

            scope:most_populated_state = {
                convert_population = {
                    target = rel:dummy_religion 
                    value = 0.04
                }

                every_scope_pop = {
                    limit = {
                        religion = rel:dummy_religion
                    }
                    move_pop = c:RVC.capital
                }
            }
        }

        capital = {
            every_scope_pop = {
                limit = {
                    has_pop_religion = rel:dummy_religion
                }
                change_pop_religion = {
                    target = root.state_religion
                    value = 1.0
                }
            }
        }
    }

	option = {
		name = blood_tribunal.4.a
	}

}

blood_tribunal.5 = {
    type = country_event
    placement = root

    title = blood_tribunal.5.t
    desc = blood_tribunal.5.d
    flavor = blood_tribunal.5.f

    duration = 3

    trigger = {
        this = c:RVC
        any_subject_or_below = {
            exists = this
        }
    }

    immediate = {
        every_subject_or_below = {
            ordered_scope_state = {
                order_by = state_population
                reverse = yes
                save_scope_as = most_populated_state
            }

            scope:most_populated_state = {
                convert_population = {
                    target = rel:dummy_religion 
                    value = 0.06
                }

                every_scope_pop = {
                    limit = {
                        religion = rel:dummy_religion
                    }
                    move_pop = c:RVC.capital
                }
            }
        }

        capital = {
            every_scope_pop = {
                limit = {
                    has_pop_religion = rel:dummy_religion
                }
                change_pop_religion = {
                    target = root.state_religion
                    value = 1.0
                }
            }
        }
    }

	option = {
		name = blood_tribunal.5.a
	}
}